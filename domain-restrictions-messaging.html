<!DOCTYPE html>
<html  lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
<script>(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create", "UA-2728311-17", {"cookieDomain":"auto"});ga("set", "anonymizeIp", true);ga("send", "pageview");</script>
<meta name="Generator" content="Drupal 8 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="sites/default/files/favicon-64.png" type="image/png" />
<link rel="alternate" hreflang="en" href="domain-restrictions-messaging.html" />
<link rel="canonical" href="domain-restrictions-messaging.html" />
<link rel="shortlink" href="domain-restrictions-messaging.html" />
<link rel="revision" href="domain-restrictions-messaging.html" />

    <title>Domain Restrictions Messaging | Brightcove Learning</title>
    <link rel="stylesheet" media="all" href="sites/default/files/css/css_d7PoQ20hWbRiei75VgExP_tm8C1ylIRfzB3zIYLc5Cw_q23msc.css" />
<link rel="stylesheet" media="all" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" />
<link rel="stylesheet" media="all" href="https://cdn.jsdelivr.net/npm/@unicorn-fail/drupal-bootstrap-styles@0.0.2/dist/3.4.0/8.x-3.x/drupal-bootstrap.min.css" />


    
<!--[if lte IE 8]>
<script src="/sites/default/files/js/js_VtafjXmRvoUgAzqzYTA3Wrjkx9wcWhjP0G4ZnnqRamA.js"></script>
<![endif]-->

    <meta name="uri-translation" content="on" />
    <script>
window['_fs_debug'] = false; window['_fs_host'] = 'fullstory.com';
window['_fs_org'] = 'BX3Q1';
window['_fs_namespace'] = 'FS';
(function(m,n,e,t,l,o,g,y){
if (e in m) {if(m.console && m.console.log) { m.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].');} return;}
g=m[e]=function(a,b){g.q?g.q.push([a,b]):g._api(a,b);};g.q=[];
o=n.createElement(t);o.async=1;o.src='https://'+_fs_host+'/s/fs.js';
y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);
g.identify=function(i,v){g(l,{uid:i});if(v)g(l,v)};g.setUserVars=function(v){g(l,v)};
g.shutdown=function(){g("rec",!1)};g.restart=function(){g("rec",!0)};
g.consent=function(a){g("consent",!arguments.length||a)};
g.identifyAccount=function(i,v){o='account';v=v||{};v.acctId=i;g(o,v)};
g.clearUserCookie=function(){};
})(window,document,window['_fs_namespace'],'script','user');
    </script>
  </head>
  <body class="path-node page-node-type-support-doc has-glyphicons">


<section id="block-gtranslate" class="block block-gtranslate block-gtranslate-block clearfix">
  
    

      



  </section>


  </div>

      </div>
      

                    <div class="navbar-collapse collapse">
            <div class="region region-navigation-collapsible">
    

  </div>

        </div>
          </header>
  
    <div class="full-width-headline">
    <div class="container">
      <div class="row">
        <div class="col-sm-12" role="heading">
            <div class="region region-header">
          <section id="block-brightcoveheadlineblock" class="block block-bc-general block-bc-general-headline-block clearfix">
  
    

      Documentation
  </section>


  </div>

        </div>
      </div>
    </div>
  </div>
  
      <div role="main" class="main-container container  js-quickedit-main-content">
    <div class="row">

                              <aside class="col-sm-3" role="complementary">
              <div class="region region-sidebar-first">
    <section class="bc-search-fixes-search-block-form block block-bc-search-fixes block-bc-search-fixes-search-block clearfix" data-drupal-selector="bc-search-fixes-search-block-form" id="block-brightcovesearchblock">
  
    

      <form action="domain-restrictions-messaging.html" method="post" id="bc-search-fixes-search-block-form" accept-charset="UTF-8">
  <div class="form-item js-form-item form-type-textfield js-form-type-textfield form-item-search js-form-item-search form-no-label form-group">
      <label for="edit-search" class="control-label sr-only">Search</label>
  
  
  <input data-drupal-selector="edit-search" class="form-text form-control" type="text" id="edit-search" name="search" value="" size="15" maxlength="128" placeholder="Search" />

  
  
  </div>
<input autocomplete="off" data-drupal-selector="form-8taunq21ihiuih4ycrccj1z4cxmebb-erib22v5zqik" type="hidden" name="form_build_id" value="form-8TaUnQ21IhIUiH4YCRCcJ1z4cXMebB-Erib22V5ZQIk" /><input data-drupal-selector="edit-bc-search-fixes-search-block-form" type="hidden" name="form_id" value="bc_search_fixes_search_block_form" /><div data-drupal-selector="edit-actions" class="form-actions form-group js-form-wrapper form-wrapper" id="edit-actions"><button data-drupal-selector="edit-submit" class="button js-form-submit form-submit btn-primary btn icon-only" type="submit" id="edit-submit" name="op" value="Search"><span class="sr-only">Search</span><span class="icon glyphicon glyphicon-search" aria-hidden="true"></span></button></div>

</form>

  </section>

<section id="block-inpagenavigationblock" class="hidden-xs block block-bc-ipnav block-bc-ipnav-block clearfix">
  
      <h2 class="block-title">On This Page</h2>
    

      <div class="bc-ipnav-block"></div>
  </section>


  </div>

          </aside>
              
                  <section class="col-sm-9">

                                      <div class="highlighted">  <div class="region region-highlighted">
    <div data-drupal-messages-fallback class="hidden"></div>

  </div>
</div>
                  
                
                
                
                          <a id="main-content"></a>
            <div class="region region-content">
        <h1 class="page-header"><span>Domain Restrictions Messaging</span>
</h1>

  
<div class="node node--type-support-doc node--view-mode-full bcdocs-four-rows clearfix">

  

  <div class="group-first-row">
      </div>

  <div class="group-second-row">
  
  <div class="field field--name-field-products field--type-entity-reference field--label-visually_hidden">
    <div class="field--label sr-only">Product(s)</div>
          <div class="field__items taxonomy__tags">
        <svg class="icon--product" viewBox="0 0 100 100">
          <use xlink:href="//support.brightcove.com/themes/custom/bcdocs/images/icons.svg#icon--product"></use>
        </svg>
              <div class="field--item">Video Cloud</div>
          <div class="field--item">Brightcove Player</div>
              </div>
      </div>

  <div class="field field--name-field-roles field--type-entity-reference field--label-visually_hidden">
    <div class="field--label sr-only">Role(s)</div>
          <div class="field__items taxonomy__tags">
        <svg class="icon--roles" viewBox="0 0 100 100">
          <use xlink:href="//support.brightcove.com/themes/custom/bcdocs/images/icons.svg#icon--roles"></use>
        </svg>
              <div class="field--item">Player Developer</div>
              </div>
      </div>

</div>

  
<div class="group-third-row taxonomy__tags">
      <svg class="icon--label" viewBox="0 0 100 100">
      <use xlink:href="//support.brightcove.com/themes/custom/bcdocs/images/icons.svg#icon--label"></use>
    </svg>
    
  <div class="field field--name-field-tasks field--type-entity-reference field--label-visually_hidden">
    <div class="field--label sr-only">Task(s)</div>
          <div class="field--items">
              <div class="field--item">Protect Videos</div>
              </div>
      </div>

  <div class="field field--name-field-topics field--type-entity-reference field--label-visually_hidden">
    <div class="field--label sr-only">Topic(s)</div>
          <div class="field--items">
              <div class="field--item">Troubleshooting/Error Handling</div>
              </div>
      </div>

</div>

  <div class="group-fourth-row">
  
            <div class="field field--name-field-support-doc-body field--type-text-with-summary field--label-hidden field--item"><!-- Place document intro sentence(s) here --><p>In this topic, you will learn how to display appropriate error messages when a video is not allowed to play because of  domain restrictions. By default, Brightcove Player does not inform the user that a video is domain restricted.</p>
            <article class="bcls-article"><section class="bcls-section"><h2 id="Overview">Overview</h2>

<p>It is possible to restrict where a video can be viewed via domain restrictions. The <a href="configuring-player-content-restrictions.html">Configuring Player Content Restrictions</a> document shows you how to use Video Cloud to apply domain restrictions. The document you are now reading instructs you how to implement code to inform users that the player is using domain restrictions.</p>

<p>By default, Brightcove Player does not inform the user that a video they are trying to view is in a domain restricted player. The player simply displays a black screen. If you view the console you will see the following.</p>

<figure class="bcls-figure"><img class="bcls-image" alt="domain restriction console error" src="https://learning-services-media.brightcove.com/doc-assets/player-development/playback/troubleshooting/domain-restrictions-messaging/domain-restrictions-error-console.png" /></figure><p>This is not terribly helpful, but if you check the <strong>Network</strong> tab and click a <strong>Name</strong> that corresponds to your video ID then check the <strong>Preview</strong> tab, you will see a more illuminating error.</p>

<figure class="bcls-figure"><img class="bcls-image" alt="domain message console network tab" src="https://learning-services-media.brightcove.com/doc-assets/player-development/playback/troubleshooting/domain-restrictions-messaging/domain-restrictions-error-network.png" /></figure><p>This document implements a strategy to let the user know the video they are trying to watch is domain restricted.</p>
</section><section class="bcls-section"><h2 id="errorobject">Player catalog's error object</h2>

<p>The key to creating a user friendly message is the <code>error</code> object contained in Brightcove Player's <code>catalog</code>. An example of a domain restriction error is shown below in a screenshot from a browser's console. Notice that the object contains a <code>data</code> property, which itself contains an array. The array will hold the last error the catalog encountered loading a video. In the example you see the element in the array is reporting a domain restriction issue.</p>

<figure class="bcls-figure"><img class="bcls-image" alt="catalog error object" src="https://learning-services-media.brightcove.com/doc-assets/player-development/playback/troubleshooting/domain-restrictions-messaging/domain-restrictions-catalog-error.png" /></figure></section><section class="bcls-section"><h2 id="bccatalogerror">Handle bc-catalog-error</h2>

<p>It is possible that handling errors in the normal <code>ready()</code> section in the <code>script</code> block can cause issues. For instance, it can happen that the <code>bc-catalog-error</code> event could be dispatched before the player is ready, and if you listen for the error in the <code>ready()</code> section, you will not be able to handle the error. You may find that there is not a problem in your code, but the issue can browser dependent, so use caution. For this reason, the error handling code in this document will use the <code>one()</code> event handling method to listen for the <code>bc-catalog-error</code> in a separate code block rather than inside the <code>ready()</code> section.</p>
</section><section class="bcls-section"><h2 id="htmlmessage">Message in HTML</h2>

<p>Once you understand the structure of the error that is produced, and where it is located, you can use JavaScript to display a descriptive error for the user. The basic implementation steps are:</p>

<ul><li>Create a target element in which to display the message.</li>
	<li>Be sure the player is ready to act upon.</li>
	<li>Check to see if any error has occurred.</li>
	<li>If yes, check to see if the error is a domain restriction issue.</li>
	<li>If yes, display message to user.</li>
</ul><p>The following code implements these steps.</p>

<ul><li>Line 8: Insert an HTML element, in this case a paragraph, in which to inject text; give the element an <code>id</code> for targeting purposes.</li>
	<li>Line 13: Use the <code>one()</code> method add an event listener for the <code>bc-catalog-error</code> event only once.</li>
	<li>Line 16: Use an <code>if</code> statement to be sure some error has occurred.</li>
	<li>Line 17: Assign a variable the specific error information from Brightcove Player catalog's error object.</li>
	<li>Line 18: Use an <code>if</code> statement to be sure the specific error information exists AND the type of error is from domain restriction.</li>
	<li>Line 19: Inject an appropriate text message into the HTML element created at line 12.</li>
</ul><pre class="line-numbers">
<code class="language-html">  &lt;video-js id="myPlayerID"
    data-video-id="3495887198001"
    data-account="1507807800001"
    data-player="4c8eb732-ba76-485c-a906-407365721633"
    data-embed="default"
    class="video-js" controls&gt;&lt;/video-js&gt;

    <span class="bcls-highlight">&lt;p id="textTarget"&gt;&lt;/p&gt;</span>

  &lt;script src="https://players.brightcove.net/1507807800001/4c8eb732-ba76-485c-a906-407365721633_default/index.min.js"&gt;&lt;/script&gt;

  &lt;script type="text/javascript"&gt;
    videojs.getPlayer('myPlayerID').<span class="bcls-highlight">one('bc-catalog-error', function(){</span>
      var myPlayer = this,
        specificError;
      <span class="bcls-highlight">if (myPlayer.catalog.error !== undefined) {
        specificError = myPlayer.catalog.error.data[0];
        if (specificError !== undefined &amp; specificError.error_subcode == "DOMAIN") {
          document.getElementById("textTarget").innerHTML = "The video you are trying to watch cannot be viewed as it is domain restricted.";
        };
      };</span>
    });

    videojs.getPlayer('myPlayerID').ready(function() {
      var myPlayer = this;
      console.log('in ready');
    });
  &lt;/script&gt;</code></pre>

<p>The following screenshot shows the message displayed below the player.</p>

<figure class="bcls-figure"><img class="bcls-image" alt="error below player" src="https://learning-services-media.brightcove.com/doc-assets/player-development/playback/troubleshooting/domain-restrictions-messaging/domain-restrictions-html-message.png" /></figure></section><section class="bcls-section"><h2 id="errorplugin">Message via errors plugin</h2>

<p>You may wish to have the message displayed in the player if the video is domain restricted. You can do this utilizing the errors plugin. The errors plugin is automatically loaded into the player, so you do not need to explicitly perform that operation. For details on the errors plugin beyond what will be mentioned here, see the <a href="display-error-messages-plugin.html">Display Error Messages Plugin</a> document.</p>

<ul><li>Line 43: Use the <code>one()</code> method add an event listener for the <code>bc-catalog-error</code> event only once.</li>
	<li>Lines 46-53: Call the player's <code>error()</code> method, passing in as an argument JSON that defines the <code>errors</code> information to display. Note that the choice of <code>-3</code> for the error code is arbitrary, and the only guidance is not to use a standard error code (currently 1-5).</li>
	<li>Line 57: Call the <code>error()</code> method to display the custom error information. The logic used to determine when the domain restriction error has occurred is the same as above. The object passed as an argument defines which error message to display.</li>
</ul><pre class="line-numbers" data-start="42">
<code class="language-html">  &lt;script type="text/javascript"&gt;
    videojs.getPlayer('myPlayerID').<span class="bcls-highlight">one('bc-catalog-error', function(){</span>
      var myPlayer = this,
        specificError;
      <span class="bcls-highlight">myPlayer.errors({
        'errors': {
          '-3': {
            'headline': 'The video you are trying to watch cannot be viewed because of domain restrictions.',
            'type': 'DOMAIN'
          }
        }
      });</span>
      if (typeof(myPlayer.catalog.error) !== 'undefined') {
        specificError = myPlayer.catalog.error.data[0];
        if (specificError !== 'undefined' &amp; specificError.error_subcode == "DOMAIN") {
          <span class="bcls-highlight">myPlayer.error({code:'-3'});</span>
        };
      };
    });

    videojs.getPlayer('myPlayerID').ready(function() {
      var myPlayer = this;
    });
  &lt;/script&gt;</code></pre>

<p>The following screenshot shows the error plugin's display of the defined error.</p>

<figure class="bcls-figure"><img class="bcls-image" alt="defined error" src="https://learning-services-media.brightcove.com/doc-assets/player-development/playback/troubleshooting/domain-restrictions-messaging/domain-restrictions-errors-plugin.png" /></figure></section><section id="generalerror" class="bcls-section"><h2>General error display</h2>

<p>The two sections above deal specifically with displaying the error generated when a geo-restricted video is viewed from a restricted locale. Some errors do not provide the level of detail the domain restriction does. An example error object of this type is shown here. Notice that the <strong>data</strong> field is empty, whereas with the domain restriction error it contained key error information.</p>

<figure class="bcls-figure"><img class="bcls-image" alt="general error object" src="https://learning-services-media.brightcove.com/doc-assets/player-development/playback/troubleshooting/domain-restrictions-messaging/domain-restrictions-general-error.png" /></figure><p>The following code shows how to display information from <code>catalog.error</code> no matter the level of detail. At a high-level, the code performs the following:</p>

<ul><li>Checks if a catalog error has occurred.</li>
	<li>Checks if in the error object the <code>data</code> field contains specific error information. If it does NOT, the general error message is injected into the HTML.</li>
	<li>If there is specific error information AND it is domain restriction related an appropriate message is injected into the HTML.</li>
	<li>If there is specific error information, and it is not domain restriction related, the specific error's message is injected into the HTML.</li>
</ul><pre class="line-numbers" data-start="69">
<code class="language-html">  &lt;script type="text/javascript"&gt;
    videojs.getPlayer('myPlayerID').one('bc-catalog-error', function(){
      var myPlayer = this,
        specificError;
      if (myPlayer.catalog.error != undefined) {
        specificError = myPlayer.catalog.error.data[0];
        if (specificError == undefined) {
          document.getElementById("textTarget").innerHTML = "The following error has occurred: &lt;strong&gt;" + myPlayer.catalog.error.message + "&lt;/strong&gt;";
        } else if (specificError.error_subcode == "DOMAIN") {
          document.getElementById("textTarget").innerHTML = "The video you are trying to watch cannot be viewed because of domain restrictions.";
        } else {
          document.getElementById("textTarget").innerHTML = "The following error has occurred: " + specificError.message;
        };
      };
    });

    videojs.getPlayer('myPlayerID').ready(function() {
      var myPlayer = this;
    });
  &lt;/script&gt;</code></pre>

<p>The following screenshot shows the general error message being displayed in HTML. Of course you could also use the errors plugin to display the message, as shown previous section of this document.</p>

<figure class="bcls-figure"><img class="bcls-image" alt="general error message display below player" src="https://learning-services-media.brightcove.com/doc-assets/player-development/playback/troubleshooting/domain-restrictions-messaging/domain-restrictions-general-message.png" /></figure></section></article></div>
      
</div>

</div>


<section class="views-element-container block block-views block-views-blockrelated-content-by-field-block-1 clearfix" id="block-views-block-related-content-by-field-block-1">
  
    

      <div class="form-group"><div class="view view-related-content-by-field view-id-related_content_by_field view-display-id-block_1 js-view-dom-id-42a2c4336c061481e5baf451b2d1df670e61e7d145c848beffd52356b35014ac">
  
    
      <div class="view-header">
      <h2>Related content</h2>
    </div>
      
      <div class="view-content">
      <div class="item-list">
  
  <ul>

          <li><div class="views-field views-field-title"><span class="field-content"><span class="content-type-support_doc"><a href="overview-content-protection.html" hreflang="en">Overview: Content Protection</a></span></span></div></li>
          <li><div class="views-field views-field-title"><span class="field-content"><span class="content-type-support_doc"><a href="configuring-player-content-restrictions.html" hreflang="en">Configuring Player Content Restrictions</a></span></span></div></li>
          <li><div class="views-field views-field-title"><span class="field-content"><span class="content-type-support_doc"><a href="restricting-video-playback-using-ip-address.html" hreflang="en">Restricting Video Playback Using IP Address</a></span></span></div></li>
          <li><div class="views-field views-field-title"><span class="field-content"><span class="content-type-support_doc"><a href="display-error-messages-plugin.html" hreflang="en">Display Error Messages Plugin</a></span></span></div></li>
    
  </ul>

</div>

    </div>
  
          </div>
</div>

  </section>


  </div>

              </section>

                </div>
  </div>

      
  
  </div>

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"node\/18052","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","google_analytics":{"trackOutbound":true,"trackMailto":true,"trackDownload":true,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip"},"bootstrap":{"forms_has_error_value_toggle":1,"modal_animation":1,"modal_backdrop":"true","modal_focus_input":1,"modal_keyboard":1,"modal_select_text":1,"modal_show":1,"modal_size":"","popover_enabled":1,"popover_animation":1,"popover_auto_close":1,"popover_container":"body","popover_content":"","popover_delay":"0","popover_html":0,"popover_placement":"right","popover_selector":"","popover_title":"","popover_trigger":"click"},"ajaxTrustedUrl":{"form_action_p_pvdeGsVG5zNF_XLGPTvYSKCf43t8qZYSwcfZl2uzM":true},"user":{"uid":0,"permissionsHash":"3b7fdb4927baca3ee2939edeb777485b3e2c2d36cf8c80e0d8f49c6dc5e2eeca"}}</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

  </body>
</html>
