<!DOCTYPE html>
<html  lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
<script>(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create", "UA-2728311-17", {"cookieDomain":"auto"});ga("set", "anonymizeIp", true);ga("send", "pageview");</script>
<meta name="Generator" content="Drupal 8 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="sites/default/files/favicon-64.png" type="image/png" />
<link rel="alternate" hreflang="en" href="dynamic-ingest-notifications-legacy-ingest.html" />
<link rel="canonical" href="dynamic-ingest-notifications-legacy-ingest.html" />
<link rel="shortlink" href="dynamic-ingest-notifications-legacy-ingest.html" />
<link rel="revision" href="dynamic-ingest-notifications-legacy-ingest.html" />

    <title>Dynamic Ingest Notifications (Legacy Ingest) | Brightcove Learning</title>
    <link rel="stylesheet" media="all" href="sites/default/files/css/css_d7PoQ20hWbRiei75VgExP_tm8C1ylIRfzB3zIYLc5Cw_q23msc.css" />
<link rel="stylesheet" media="all" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" />
<link rel="stylesheet" media="all" href="https://cdn.jsdelivr.net/npm/@unicorn-fail/drupal-bootstrap-styles@0.0.2/dist/3.4.0/8.x-3.x/drupal-bootstrap.min.css" />


    
<!--[if lte IE 8]>
<script src="/sites/default/files/js/js_VtafjXmRvoUgAzqzYTA3Wrjkx9wcWhjP0G4ZnnqRamA.js"></script>
<![endif]-->

    <meta name="uri-translation" content="on" />
    <script>
window['_fs_debug'] = false; window['_fs_host'] = 'fullstory.com';
window['_fs_org'] = 'BX3Q1';
window['_fs_namespace'] = 'FS';
(function(m,n,e,t,l,o,g,y){
if (e in m) {if(m.console && m.console.log) { m.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].');} return;}
g=m[e]=function(a,b){g.q?g.q.push([a,b]):g._api(a,b);};g.q=[];
o=n.createElement(t);o.async=1;o.src='https://'+_fs_host+'/s/fs.js';
y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);
g.identify=function(i,v){g(l,{uid:i});if(v)g(l,v)};g.setUserVars=function(v){g(l,v)};
g.shutdown=function(){g("rec",!1)};g.restart=function(){g("rec",!0)};
g.consent=function(a){g("consent",!arguments.length||a)};
g.identifyAccount=function(i,v){o='account';v=v||{};v.acctId=i;g(o,v)};
g.clearUserCookie=function(){};
})(window,document,window['_fs_namespace'],'script','user');
    </script>
  </head>
  <body class="path-node page-node-type-support-doc has-glyphicons">


<section id="block-gtranslate" class="block block-gtranslate block-gtranslate-block clearfix">
  
    

      



  </section>


  </div>

      </div>
      

                    <div class="navbar-collapse collapse">
            <div class="region region-navigation-collapsible">
    

  </div>

        </div>
          </header>
  
    <div class="full-width-headline">
    <div class="container">
      <div class="row">
        <div class="col-sm-12" role="heading">
            <div class="region region-header">
          <section id="block-brightcoveheadlineblock" class="block block-bc-general block-bc-general-headline-block clearfix">
  
    

      Documentation
  </section>


  </div>

        </div>
      </div>
    </div>
  </div>
  
      <div role="main" class="main-container container  js-quickedit-main-content">
    <div class="row">

                              <aside class="col-sm-3" role="complementary">
              <div class="region region-sidebar-first">
    <section class="bc-search-fixes-search-block-form block block-bc-search-fixes block-bc-search-fixes-search-block clearfix" data-drupal-selector="bc-search-fixes-search-block-form" id="block-brightcovesearchblock">
  
    

      <form action="dynamic-ingest-notifications-legacy-ingest.html" method="post" id="bc-search-fixes-search-block-form" accept-charset="UTF-8">
  <div class="form-item js-form-item form-type-textfield js-form-type-textfield form-item-search js-form-item-search form-no-label form-group">
      <label for="edit-search" class="control-label sr-only">Search</label>
  
  
  <input data-drupal-selector="edit-search" class="form-text form-control" type="text" id="edit-search" name="search" value="" size="15" maxlength="128" placeholder="Search" />

  
  
  </div>
<input autocomplete="off" data-drupal-selector="form-jhkzpzmuserdfff-vwewb2sdfnlbqd6joamhpywj0wc" type="hidden" name="form_build_id" value="form-jHkZpZmUSERDFFf_vWewb2SdFnlBqd6joAMhPyWJ0Wc" /><input data-drupal-selector="edit-bc-search-fixes-search-block-form" type="hidden" name="form_id" value="bc_search_fixes_search_block_form" /><div data-drupal-selector="edit-actions" class="form-actions form-group js-form-wrapper form-wrapper" id="edit-actions"><button data-drupal-selector="edit-submit" class="button js-form-submit form-submit btn-primary btn icon-only" type="submit" id="edit-submit" name="op" value="Search"><span class="sr-only">Search</span><span class="icon glyphicon glyphicon-search" aria-hidden="true"></span></button></div>

</form>

  </section>

<section id="block-inpagenavigationblock" class="hidden-xs block block-bc-ipnav block-bc-ipnav-block clearfix">
  
      <h2 class="block-title">On This Page</h2>
    

      <div class="bc-ipnav-block"></div>
  </section>


  </div>

          </aside>
              
                  <section class="col-sm-9">

                                      <div class="highlighted">  <div class="region region-highlighted">
    <div data-drupal-messages-fallback class="hidden"></div>

  </div>
</div>
                  
                
                
                
                          <a id="main-content"></a>
            <div class="region region-content">
        <h1 class="page-header"><span>Dynamic Ingest Notifications (Legacy Ingest)</span>
</h1>

  
<div class="node node--type-support-doc node--view-mode-full bcdocs-four-rows clearfix">

  

  <div class="group-first-row">
      </div>

  <div class="group-second-row">
  
  <div class="field field--name-field-products field--type-entity-reference field--label-visually_hidden">
    <div class="field--label sr-only">Product(s)</div>
          <div class="field__items taxonomy__tags">
        <svg class="icon--product" viewBox="0 0 100 100">
          <use xlink:href="//support.brightcove.com/themes/custom/bcdocs/images/icons.svg#icon--product"></use>
        </svg>
              <div class="field--item">Video Cloud</div>
              </div>
      </div>

  <div class="field field--name-field-roles field--type-entity-reference field--label-visually_hidden">
    <div class="field--label sr-only">Role(s)</div>
          <div class="field__items taxonomy__tags">
        <svg class="icon--roles" viewBox="0 0 100 100">
          <use xlink:href="//support.brightcove.com/themes/custom/bcdocs/images/icons.svg#icon--roles"></use>
        </svg>
              <div class="field--item">API Developer</div>
              </div>
      </div>

</div>

  
<div class="group-third-row taxonomy__tags">
      <svg class="icon--label" viewBox="0 0 100 100">
      <use xlink:href="//support.brightcove.com/themes/custom/bcdocs/images/icons.svg#icon--label"></use>
    </svg>
    
  <div class="field field--name-field-tasks field--type-entity-reference field--label-visually_hidden">
    <div class="field--label sr-only">Task(s)</div>
          <div class="field--items">
              <div class="field--item">Add Videos/Assets</div>
              </div>
      </div>

  <div class="field field--name-field-topics field--type-entity-reference field--label-visually_hidden">
    <div class="field--label sr-only">Topic(s)</div>
          <div class="field--items">
              <div class="field--item">Notifications</div>
          <div class="field--item">Troubleshooting/Error Handling</div>
              </div>
      </div>

  <div class="field field--name-field-apis field--type-entity-reference field--label-visually_hidden">
    <div class="field--label sr-only">API(s)</div>
          <div class="field--items">
              <div class="field--item">Dynamic Ingest API</div>
              </div>
      </div>

</div>

  <div class="group-fourth-row">
  
            <div class="field field--name-field-support-doc-body field--type-text-with-summary field--label-hidden field--item"><p>In this topic, you will learn about Dynamic Ingest notifications, which provide information about the progress of your ingest jobs.</p>
                <article class="bcls-article"><section class="bcls-section"><h2 id="diAPI">Dynamic Ingest API notifications</h2>

<p>You can specify one or more callback URLs to receive notifications for the results of the ingest process. The URLs you specify should be for apps than can accept POST requests. Notifications will be sent in JSON format.</p>

<aside class="bcls-aside bcls-aside--information"><h3>Notes</h3>

<ul><li>Up to 10 subscribers for error notifications are supported. You can include more than 10 URLs to have notifications sent to, but only the first 10 will be processed</li>
	<li>URLs ending in a slash (/) will not be accepted; for example, the url “https://my.domain.com/notification-receiver” works, but “https://my.domain.com/notification-receiver/” does not</li>
	<li>Alternatively, you can use the <a href="https://docs.brightcove.com/cms-api/v1/doc/index.html#api-videoGroup-Get_Status_of_Ingest_Jobs">status APIs of the CMS API</a> to get the status of ingest jobs for a particular video.</li>
	<li>Notification handlers on servers built on HTTP2 are not currenly supported. Notifications sent to HTTP2 servers may fail to be delivered without returning any error.</li>
</ul></aside><h3>Setup</h3>

<p>Here’s an example.</p>

<ul><li>User with pub id 57838016001</li>
	<li>Wants to use Dynamic Ingest to upload a source video file located at https://s3.amazonaws.com/bucket/mysourcevideo.mp4</li>
	<li>Wants to upload an existing title in the catalog with video id 5199670523001</li>
	<li>Using the high-resolution profile</li>
	<li>Wants to receive callbacks at two endpoints located at http://host1/path1 and http://host2/path2 respectively</li>
</ul><p>The DI request would look like this:</p>

<h4>POST Request</h4>
<textarea class="bcls-code">https://ingest.api.brightcove.com/v1/accounts/57838016001/videos/5199670523001/ingest-requests</textarea><h4>Request body</h4>
<textarea class="bcls-code" style="height:10em;">{ "master": { "url": "https://s3.amazonaws.com/bucket/mysourcevideo.mp4" }, "profile": "high-resolution", "callbacks":
			["http://host1/path1”, “http://host2/path2”] }
		</textarea><h3>Sample notification</h3>

<p>Notifications are sent as POST requests with the notification in the request body as JSON <sup><strong> <a href="#note1">[1]</a> </strong> </sup>. Here are some sample notification:</p>

<pre class="line-numbers">
<code class="language-json">{
    "accountId": "57838016001",
    "entityType": "ASSET",
    "version": "1",
    "status": "SUCCESS",
    "videoId": "5199670523001",
    "entity": "5199679295001",
    "action": "CREATE",
    "jobId": "699db2e5-aeb7-4765-a4a7-2cc68c7360bd"
}
{
    "action": "CREATE",
    "status": "SUCCESS",
    "entityType": "DIGITAL_MASTER",
    "videoId": "5199670523001",
    "entity": "5199670523001",
    "accountId": "57838016001",
    "version": "1",
    "jobId": "699db2e5-aeb7-4765-a4a7-2cc68c7360bd"
}
{
    "entityType": "ASSET",
    "status": "SUCCESS",
    "action": "CREATE",
    "entity": "5199680423001",
    "profileRefId": "ts7",
    "version": "1",
    "accountId": "57838016001",
    "videoId": "5199670523001",
    "jobId": "699db2e5-aeb7-4765-a4a7-2cc68c7360bd"
}
{
    "jobId": "699db2e5-aeb7-4765-a4a7-2cc68c7360bd",
    "accountId": "57838016001",
    "version": "1",
    "status": "SUCCESS",
    "entityType": "TITLE",
    "entity": "5199670523001",
    "videoId": "5199670523001",
    "action": "CREATE"
}</code></pre>

<h4>Notes</h4>

<ul><li id="note1"><sup><strong>[1]</strong> </sup> Exception: All notifications for DRM-packaged content are returned as key/value pairs. In this case, the <code>Content-Type</code> header will be <code>application/x-www-form-urlencoded</code>. Otherwise, the <code>Content-Type</code> will be <code>application/json</code></li>
</ul><h3>Notification fields</h3>

<table class="bcls-table"><thead class="bcls-table__head"><tr><th>Item</th>
			<th>Description</th>
		</tr></thead><tbody class="bcls-table__body"><tr><td><code>status</code></td>
			<td>will be <code>FAILED</code> if the ingest or creation of a rendition was not successful, <code>SUCCESS</code> if the request succeeded</td>
		</tr><tr><td><code>accountId</code></td>
			<td>the account id</td>
		</tr><tr><td><code>videoId</code></td>
			<td>the video id</td>
		</tr><tr><td><code>jobId</code></td>
			<td>the job id for the Dynamic Ingest request</td>
		</tr><tr><td style="vertical-align:top;"><code>profileRefId</code></td>
			<td>
			<p>For video renditions, this will be the <code>reference id</code> you specified for the rendition in your ingest profile.</p>

			<p>For manifests, the <code>profileRefId</code> will indicate the type of the manifest:</p>

			<ul><li><code>HlsManifest</code> for an HLS NG manifest</li>
				<li><code>HdsManifest</code> for an HDS manifest</li>
				<li><code>DashManifest</code> for DASH manifests (2 - one of the Manifest assets is used for consumption in the MAPI, the other is used for consumption in the CMS API)</li>
				<li><code>SmoothIsmManifest</code> for a Smooth manifest (2 - one of the Manifest assets is used for consumption in the MAPI, the other is used for consumption in the CMS API)</li>
			</ul></td>
		</tr><tr><td><code>entity</code></td>
			<td>if it exists, the Video Cloud id of the asset that was ingested or failed (if the video object was successfully created in Video Cloud)</td>
		</tr><tr><td><code>entityType</code></td>
			<td>the kind of asset reported on - for example: TITLE (a video), DIGITAL_MASTER, ASSET (a rendition, captions file, or image)</td>
		</tr><tr><td><code>errorMessage</code></td>
			<td>an explanation of why the ingest failed if it did</td>
		</tr><tr><td><code>version</code></td>
			<td>a string always equal to <code>"1"</code></td>
		</tr><tr><td><code>action</code></td>
			<td>the action that occurred - for example, CREATE</td>
		</tr></tbody></table><h3>Interpreting notifications</h3>

<p>A notification containing <code>"action": "CREATE"</code> and <code>"status": "SUCCESS"</code> indicates completion of a process.</p>

<ul><li>If the <code>entityType</code> is <code>TITLE</code>, then processing of an ingested video is complete.</li>
	<li>If the <code>entityType</code> is <code>ASSET</code>, then a rendition, image, manifest, or WebVTT file has been successfully added to your video.</li>
</ul><p class="BCL-aside">Note: a <code>"status": "SUCCESS"</code> on a <strong>title</strong> indicates that processing is complete, but does not necessarily mean that it was all renditions were created successfully. To determine whether Dynamic Ingest of videos was successful, see <a href="get-status-dynamic-ingest-requests-legacy-ingest.html">Get Status of Dynamic Ingest Requests</a></p>
</section><section class="bcls-section"><h2 id="sampleApp">Basic Sample app</h2>

<p>Below is code for a simple logging app for Dynamic Ingest API notification. This app is written in PHP, but you can use any language, as long as the app has a public-facing URL and can handle http(s) POST requests.</p>

<p>You can see the log file that this app generates <a href="https://solutions.brightcove.com/bcls/di-api/di-log.txt">here.</a></p>

<p class="BCL-aside">Note: if you try to implement this app for yourself, you will need to make sure that the app has permission to write to your log file. Also remember that the log file can grow quickly - you will probably want to empty it on a regular basis.</p>

<pre class="line-numbers">
<code class="language-php">&lt;?php
// POST won't work for JSON data
$problem = "No errors";
try {
    $json    = file_get_contents('php://input');
    $decoded = json_decode($json, true);
} catch (Exception $e) {
    $problem = $e-&gt;getMessage();
}

// turn notification into pretty printed JSON
$notification = json_encode($decoded, JSON_PRETTY_PRINT);



$logEntry = $notification.
"\nErrors receiving notificatons: ".$problem.
"\n-------------------------------\n";

// Lastly, tell PHP where it can find the log file and tell PHP to open it
// and add the string we created earlier to it.
$logFileLocation = "di-log.txt";
$fileHandle      = fopen($logFileLocation, 'a') or die("-1");
fwrite($fileHandle, $logEntry);
fclose($fileHandle);

// line below is displayed when you browse the app directly
echo "Dynamic Ingest callback app is running";
?&gt;
</code></pre>
</section></article></div>
      
</div>

</div>


<section class="views-element-container block block-views block-views-blockrelated-content-by-field-block-1 clearfix" id="block-views-block-related-content-by-field-block-1">
  
    

      <div class="form-group"><div class="view view-related-content-by-field view-id-related_content_by_field view-display-id-block_1 js-view-dom-id-483bea3f266e1a2bd217ad846f4a23b6209660cf49af56a20772c3f4c36968e7">
  
    
      <div class="view-header">
      <h2>Related content</h2>
    </div>
      
      <div class="view-content">
      <div class="item-list">
  
  <ul>

          <li><div class="views-field views-field-title"><span class="field-content"><span class="content-type-support_doc"><a href="overview-dynamic-ingest-api-legacy-ingest.html" hreflang="en"> Overview: Dynamic Ingest API (Legacy Ingest)</a></span></span></div></li>
          <li><div class="views-field views-field-title"><span class="field-content"><span class="content-type-support_doc"><a href="get-status-dynamic-ingest-requests-legacy-ingest.html" hreflang="en">Get Status of Dynamic Ingest Requests (Legacy Ingest)</a></span></span></div></li>
          <li><div class="views-field views-field-title"><span class="field-content"><span class="content-type-support_doc"><a href="quick-start-dynamic-ingest-api-legacy-ingest.html" hreflang="en"> Quick Start: Dynamic Ingest API (Legacy Ingest)</a></span></span></div></li>
    
  </ul>

</div>

    </div>
  
          </div>
</div>

  </section>


  </div>

              </section>

                </div>
  </div>

      
  
  </div>

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"node\/17939","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","google_analytics":{"trackOutbound":true,"trackMailto":true,"trackDownload":true,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip"},"bootstrap":{"forms_has_error_value_toggle":1,"modal_animation":1,"modal_backdrop":"true","modal_focus_input":1,"modal_keyboard":1,"modal_select_text":1,"modal_show":1,"modal_size":"","popover_enabled":1,"popover_animation":1,"popover_auto_close":1,"popover_container":"body","popover_content":"","popover_delay":"0","popover_html":0,"popover_placement":"right","popover_selector":"","popover_title":"","popover_trigger":"click"},"ajaxTrustedUrl":{"form_action_p_pvdeGsVG5zNF_XLGPTvYSKCf43t8qZYSwcfZl2uzM":true},"user":{"uid":0,"permissionsHash":"3b7fdb4927baca3ee2939edeb777485b3e2c2d36cf8c80e0d8f49c6dc5e2eeca"}}</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

  <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"e78a80aa93","applicationID":"129613202","transactionName":"YwBUZkcFVktUWhJQX1pKd1FBDVdWGkkHXlVrBldRXQE=","queueTime":0,"applicationTime":13,"atts":"T0dXEA8fRUU=","errorBeacon":"bam.nr-data.net","agent":""}</script></body>
</html>
