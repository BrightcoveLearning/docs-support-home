<!DOCTYPE html>
<html  lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
<script>(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create", "UA-2728311-17", {"cookieDomain":"auto"});ga("set", "anonymizeIp", true);ga("send", "pageview");</script>
<meta name="Generator" content="Drupal 8 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="sites/default/files/favicon-64.png" type="image/png" />
<link rel="alternate" hreflang="en" href="dynamic-delivery-ingest-priority-queueing.html" />
<link rel="canonical" href="dynamic-delivery-ingest-priority-queueing.html" />
<link rel="shortlink" href="dynamic-delivery-ingest-priority-queueing.html" />
<link rel="revision" href="dynamic-delivery-ingest-priority-queueing.html" />

    <title>Dynamic Delivery Ingest Priority Queueing | Brightcove Learning</title>
    <link rel="stylesheet" media="all" href="sites/default/files/css/css_d7PoQ20hWbRiei75VgExP_tm8C1ylIRfzB3zIYLc5Cw_q23msc.css" />
<link rel="stylesheet" media="all" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" />
<link rel="stylesheet" media="all" href="https://cdn.jsdelivr.net/npm/@unicorn-fail/drupal-bootstrap-styles@0.0.2/dist/3.4.0/8.x-3.x/drupal-bootstrap.min.css" />


    
<!--[if lte IE 8]>
<script src="/sites/default/files/js/js_VtafjXmRvoUgAzqzYTA3Wrjkx9wcWhjP0G4ZnnqRamA.js"></script>
<![endif]-->

    <meta name="uri-translation" content="on" />
    <script>
window['_fs_debug'] = false; window['_fs_host'] = 'fullstory.com';
window['_fs_org'] = 'BX3Q1';
window['_fs_namespace'] = 'FS';
(function(m,n,e,t,l,o,g,y){
if (e in m) {if(m.console && m.console.log) { m.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].');} return;}
g=m[e]=function(a,b){g.q?g.q.push([a,b]):g._api(a,b);};g.q=[];
o=n.createElement(t);o.async=1;o.src='https://'+_fs_host+'/s/fs.js';
y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);
g.identify=function(i,v){g(l,{uid:i});if(v)g(l,v)};g.setUserVars=function(v){g(l,v)};
g.shutdown=function(){g("rec",!1)};g.restart=function(){g("rec",!0)};
g.consent=function(a){g("consent",!arguments.length||a)};
g.identifyAccount=function(i,v){o='account';v=v||{};v.acctId=i;g(o,v)};
g.clearUserCookie=function(){};
})(window,document,window['_fs_namespace'],'script','user');
    </script>
  </head>
  <body class="path-node page-node-type-support-doc has-glyphicons">


<section id="block-gtranslate" class="block block-gtranslate block-gtranslate-block clearfix">
  
    

      



  </section>


  </div>

      </div>
      

                    <div class="navbar-collapse collapse">
            <div class="region region-navigation-collapsible">
    

  </div>

        </div>
          </header>
  
    <div class="full-width-headline">
    <div class="container">
      <div class="row">
        <div class="col-sm-12" role="heading">
            <div class="region region-header">
          <section id="block-brightcoveheadlineblock" class="block block-bc-general block-bc-general-headline-block clearfix">
  
    

      Documentation
  </section>


  </div>

        </div>
      </div>
    </div>
  </div>
  
      <div role="main" class="main-container container  js-quickedit-main-content">
    <div class="row">

                              <aside class="col-sm-3" role="complementary">
              <div class="region region-sidebar-first">
    <section class="bc-search-fixes-search-block-form block block-bc-search-fixes block-bc-search-fixes-search-block clearfix" data-drupal-selector="bc-search-fixes-search-block-form" id="block-brightcovesearchblock">
  
    

      <form action="dynamic-delivery-ingest-priority-queueing.html" method="post" id="bc-search-fixes-search-block-form" accept-charset="UTF-8">
  <div class="form-item js-form-item form-type-textfield js-form-type-textfield form-item-search js-form-item-search form-no-label form-group">
      <label for="edit-search" class="control-label sr-only">Search</label>
  
  
  <input data-drupal-selector="edit-search" class="form-text form-control" type="text" id="edit-search" name="search" value="" size="15" maxlength="128" placeholder="Search" />

  
  
  </div>
<input autocomplete="off" data-drupal-selector="form-5uwksxomv7842asslzqem3b9-rvpnphkysr0-kknpew" type="hidden" name="form_build_id" value="form-5uWKsXomv7842aSSLZQeM3b9-rVpNPHKYsR0_KknpEw" /><input data-drupal-selector="edit-bc-search-fixes-search-block-form" type="hidden" name="form_id" value="bc_search_fixes_search_block_form" /><div data-drupal-selector="edit-actions" class="form-actions form-group js-form-wrapper form-wrapper" id="edit-actions"><button data-drupal-selector="edit-submit" class="button js-form-submit form-submit btn-primary btn icon-only" type="submit" id="edit-submit" name="op" value="Search"><span class="sr-only">Search</span><span class="icon glyphicon glyphicon-search" aria-hidden="true"></span></button></div>

</form>

  </section>

<section id="block-inpagenavigationblock" class="hidden-xs block block-bc-ipnav block-bc-ipnav-block clearfix">
  
      <h2 class="block-title">On This Page</h2>
    

      <div class="bc-ipnav-block"></div>
  </section>


  </div>

          </aside>
              
                  <section class="col-sm-9">

                                      <div class="highlighted">  <div class="region region-highlighted">
    <div data-drupal-messages-fallback class="hidden"></div>

  </div>
</div>
                  
                
                
                
                          <a id="main-content"></a>
            <div class="region region-content">
        <h1 class="page-header"><span>Dynamic Delivery Ingest Priority Queueing</span>
</h1>

  
<div class="node node--type-support-doc node--view-mode-full bcdocs-four-rows clearfix">

  

  <div class="group-first-row">
      </div>

  <div class="group-second-row">
  
  <div class="field field--name-field-products field--type-entity-reference field--label-visually_hidden">
    <div class="field--label sr-only">Product(s)</div>
          <div class="field__items taxonomy__tags">
        <svg class="icon--product" viewBox="0 0 100 100">
          <use xlink:href="//support.brightcove.com/themes/custom/bcdocs/images/icons.svg#icon--product"></use>
        </svg>
              <div class="field--item">Video Cloud</div>
              </div>
      </div>

  <div class="field field--name-field-roles field--type-entity-reference field--label-visually_hidden">
    <div class="field--label sr-only">Role(s)</div>
          <div class="field__items taxonomy__tags">
        <svg class="icon--roles" viewBox="0 0 100 100">
          <use xlink:href="//support.brightcove.com/themes/custom/bcdocs/images/icons.svg#icon--roles"></use>
        </svg>
              <div class="field--item">API Developer</div>
              </div>
      </div>

</div>

  
<div class="group-third-row taxonomy__tags">
      <svg class="icon--label" viewBox="0 0 100 100">
      <use xlink:href="//support.brightcove.com/themes/custom/bcdocs/images/icons.svg#icon--label"></use>
    </svg>
    
  <div class="field field--name-field-tasks field--type-entity-reference field--label-visually_hidden">
    <div class="field--label sr-only">Task(s)</div>
          <div class="field--items">
              <div class="field--item">Add Videos/Assets</div>
              </div>
      </div>

  <div class="field field--name-field-topics field--type-entity-reference field--label-visually_hidden">
    <div class="field--label sr-only">Topic(s)</div>
          <div class="field--items">
              <div class="field--item">Dynamic Delivery</div>
              </div>
      </div>

  <div class="field field--name-field-apis field--type-entity-reference field--label-visually_hidden">
    <div class="field--label sr-only">API(s)</div>
          <div class="field--items">
              <div class="field--item">Dynamic Ingest API</div>
              </div>
      </div>

</div>

  <div class="group-fourth-row">
  
            <div class="field field--name-field-support-doc-body field--type-text-with-summary field--label-hidden field--item"><p>This topic explains how to use the priority setting to optimize ingestion time for high priority videos.</p><article class="bcls-article"><section class="bcls-section"><h2 id="Introduction">Introduction</h2>

<p>Dynamic Delivery Ingest now has a feature called <strong>Priority Queueing</strong> that allow publishers to submit ingest jobs to us with a desired priority setting to influence the order and timeliness of when the job will be processed.</p>

<aside><p>Note that Priority Queueing applies only to accounts that are enabled for <a href="overview-dynamic-ingest-api-dynamic-delivery.html">Dynamic Delivery</a>. It cannot be used in accounts that use the legacy ingestion system.</p>

<p>If you would like to convert your account to use Dynamic Delivery, contact your account manager.</p>

<p>If you are not sure whether Dynamic Delivery is enabled for your account, the easiest way to tell is to open <a href="https://studio.brightcove.com">Studio</a> and go to the Upload Module. Click the Ingest Profile dropdown menu to expand it. If your account is enabled for Dynamic Delivery, you will see Dynamic Delivery profiles at the top of the list:</p>

<figure class="bcls-figure"><img class="bcls-image" alt="Dynamic Delivery Profiles" src="https://learning-services-media.brightcove.com/doc-assets/node/18439-dynamic-delivery-ingest-priority-queueing/18439-dd-profiles-in-upload-module.png" /><figcaption class="bcls-caption--image">Dynamic Delivery Profiles</figcaption></figure></aside></section><section class="bcls-section"><h2 id="how-dynamic-delivery-ingestion-currently-works">How Dynamic Delivery ingestion queueing works</h2>

<p>With normal priority queueing, Dynamic Delivery Ingestion has a limit of 100 active jobs per account. When that limit is exceeded, the ingestion system will queue up additional requests for processing later. The size of the queue has a separate limit, and when that is reached it will reject the ingestion request back to the customer (with a 429 error code). When jobs finish up, capacity is freed up and jobs that are queued will be picked up and processed one at a time, in the order they were received.</p>

<p>The video status in the CMS API does not reflect that the job was queued - the status will be <code>pending </code> whether the job is processing or queued.</p>
</section><section class="bcls-section"><h2 id="How_Priority_Queueing_affects_ingestion">How Priority Queueing affects ingestion</h2>

<p>Priority queueing allows the user to add a <code>priority </code> flag to an ingest request. The allowable values for <code>priority </code> are <code>low </code> and <code>normal </code>. Any other value will cause the request to be rejected with a 422 error code. When the user doesn't specify any priority, the default value of <code>normal </code> is used. Here is a brief description of how Priority Queueing changes how jobs are processed from the queue:</p>

<ol><li>If there are no queued jobs and there is capacity to run a job, then the job is run immediately. This applies to both low and normal priority jobs.</li>
	<li>If there is is no capacity for another job to run, the job is queued.</li>
	<li>If there are jobs in the queue, then any new jobs are also queued. This means that a new job can't start before queued jobs.</li>
	<li>When there is capacity to run another job and there are queued jobs, a job is taken from the queue:
	<ul><li>If there are ANY normal priority jobs in the queue, the oldest normal priority job will be picked.</li>
		<li>If there are NO normal priority jobs in the queue, then the oldest low priority job will be picked.</li>
	</ul></li>
	<li>Normal and Low priority jobs are treated the <strong>same</strong> for how many running jobs there can be. The total number of jobs processing, whatever their priority, is limited to 100 per account.</li>
	<li>There are <strong>separate</strong> quotas for how many normal and low priority jobs can be queued.</li>
</ol></section><section class="bcls-section"><h2 id="What_to_watch_out_for">What to watch out for</h2>

<h3>Rendition details changed after submitting a job</h3>

<p>When you create a Dynamic Ingest job, the ingest profile specified is copied by the Dynamic Ingest system, and that profile <strong>copy</strong> will be used for processing even if the profile has been modified since the job was submitted.</p>

<p>For low priority jobs, where processing could be delayed for a significant amount of time in some cases, <strong>the renditions specified in that profile could be modified</strong> before the job is actually processed. If that happens, the renditions used to process the video will be the <strong>NEW</strong> definition of those renditions; not the definition of the renditions at the time the job was submitted.</p>

<p>If you wish to <strong>guarantee</strong> you get the renditions <strong>as they were specified when the job was submitted</strong>, you should make copies of the renditions and create a new profile that references those copied renditions, then start the ingestion process. (You can retranscode the video with the updated profile if the video has already been put into Video Cloud. Remember that you cannot retranscode the video until processing for the original job is complete.)</p>

<h3>Source file upload</h3>

<p>Source file upload will delete files in that S3 bucket after 24-hours. Since low priority jobs may not be processed for more than 24-hours in some cases, the file(s) may have already been deleted, and processing in that case will fail. <strong>We do not recommend low priority ingestion for source file upload</strong>.</p>
</section><section class="bcls-section"><h2 id="sample_request">Sample requests</h2>

<p>Below is a sample of an ingest request body with low priority:</p>

<pre class="line-numbers">
<code class="language-json">{
"master": {
"url": "http://host/master.mp4"
},
"profile": "multi-platform-extended-static",
<span class="bcls-highlight">"priority": "low"</span>,
"callbacks": [
"http://mydomain.com/di-callbacks.php"
]
}
</code>
</pre>

<p>And here's a sample of a normal priority job:</p>

<pre class="line-numbers">
<code class="language-json">{
"master": {
"url": "http://host/master.mp4"
},
"profile": "multi-platform-extended-static",
<span class="bcls-highlight">"priority": "normal"</span>,
"callbacks": [
"http://mydomain.com/di-callbacks.php"
]
}
</code>
</pre>

<p>Note that since <code>normal </code> is the default value, the previous request would be processed in exactly the same way as the following one:</p>

<pre class="line-numbers">
<code class="language-json">{
"master": {
"url": "http://host/master.mp4"
},
"profile": "multi-platform-extended-static",
"callbacks": [
"http://mydomain.com/di-callbacks.php"
]
}
</code>
</pre>
</section><section class="bcls-section"><h2 id="Using_the_priority_queue">Using the priority queue</h2>

<p>From the last example in the previous section, it should be clear that if you do <strong>not</strong> use the <code>priority </code> field in your ingest jobs, they will continue to be processed exactly as they have been.</p>

<p>The addition of the <code>priority </code> field will benefit you mainly if:</p>

<ol><li>You ingest a fairly large number of videos</li>
	<li>It is critical to get <em>some</em> of your videos online as soon as possible, while there is no urgency to publish others (because the content is less important, or you do not plan to publish the videos immediately anyway)</li>
	<li>You have videos that you want to retranscode, but you do not want that to slow down ingestion of new content</li>
</ol></section><section class="bcls-section"><h2 id="How_low_priority_queue_works">How the low priority queue works</h2>

<p>This section explains how the low priority queue works.</p>

<p>There is no guarantee when normal or low priority jobs will be started. However, normal priority jobs will always be started before low priority jobs.</p>

<p>If you have a steady, fast rate of submitting normal priority jobs, it could take considerable time before low priority jobs are started.</p>

<p>Low priority jobs may take longer to start and also longer to process than normal priority for the same video.</p>
</section></article></div>
      
</div>

</div>


<section class="views-element-container block block-views block-views-blockrelated-content-by-field-block-1 clearfix" id="block-views-block-related-content-by-field-block-1">
  
    

      <div class="form-group"><div class="view view-related-content-by-field view-id-related_content_by_field view-display-id-block_1 js-view-dom-id-6f78e3d1002fd812ef92b2791554805f77aaab30a276df2752febaa0e565a33a">
  
    
      <div class="view-header">
      <h2>Related content</h2>
    </div>
      
      <div class="view-content">
      <div class="item-list">
  
  <ul>

          <li><div class="views-field views-field-title"><span class="field-content"><span class="content-type-support_doc"><a href="dynamic-ingest-api-sample-ingesting-low-priority-videos-dynamic-delivery.html" hreflang="en">Dynamic Ingest API Sample: Ingesting Low Priority Videos (Dynamic Delivery)</a></span></span></div></li>
          <li><div class="views-field views-field-title"><span class="field-content"><span class="content-type-support_doc"><a href="overview-dynamic-ingest-api-dynamic-delivery.html" hreflang="en"> Overview: Dynamic Ingest API for Dynamic Delivery</a></span></span></div></li>
          <li><div class="views-field views-field-title"><span class="field-content"><span class="content-type-support_doc"><a href="notifications-dynamic-delivery-video-cloud.html" hreflang="en">Notifications for Dynamic Delivery in Video Cloud</a></span></span></div></li>
    
  </ul>

</div>

    </div>
  
          </div>
</div>

  </section>


  </div>

              </section>

                </div>
  </div>

      
  
  </div>

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"node\/18439","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","google_analytics":{"trackOutbound":true,"trackMailto":true,"trackDownload":true,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip"},"bootstrap":{"forms_has_error_value_toggle":1,"modal_animation":1,"modal_backdrop":"true","modal_focus_input":1,"modal_keyboard":1,"modal_select_text":1,"modal_show":1,"modal_size":"","popover_enabled":1,"popover_animation":1,"popover_auto_close":1,"popover_container":"body","popover_content":"","popover_delay":"0","popover_html":0,"popover_placement":"right","popover_selector":"","popover_title":"","popover_trigger":"click"},"ajaxTrustedUrl":{"form_action_p_pvdeGsVG5zNF_XLGPTvYSKCf43t8qZYSwcfZl2uzM":true},"user":{"uid":0,"permissionsHash":"3b7fdb4927baca3ee2939edeb777485b3e2c2d36cf8c80e0d8f49c6dc5e2eeca"}}</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

  <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"e78a80aa93","applicationID":"129613202","transactionName":"YwBUZkcFVktUWhJQX1pKd1FBDVdWGn0UTEBVCWpxWhZdZHNWFFRscgpEX3cRUVRRXBQUDkYAWFZQFmhUVFoDUV9YAVNAcwtKVXRaElBfWg==","queueTime":0,"applicationTime":214,"atts":"T0dXEA8fRUU=","errorBeacon":"bam.nr-data.net","agent":""}</script></body>
</html>
